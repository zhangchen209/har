source('~/Box Sync/19Fall/har/rcode/main.R')
install.packages('foreach')
source('~/Box Sync/19Fall/har/rcode/main.R')
install.packages('doSNOW')
source('~/Box Sync/19Fall/har/rcode/main.R')
source('~/Box Sync/19Fall/har/rcode/main.R')
load("/Users/chenzhang/Downloads/r_har.RData")
View(cv_max)
rm(list=ls())
load("/Users/chenzhang/Downloads/r_har.RData")
source('~/Box Sync/19Fall/har/rcode/main.R')
source('~/Box Sync/19Fall/har/rcode/main.R')
View(cv_pp)
source('~/Box Sync/19Fall/har/rcode/main.R')
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/r_har.RData")
source('~/Box Sync/19Fall/har/rcode/main.R')
View(w)
View(cv_max)
source('~/Box Sync/19Fall/har/rcode/main.R')
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/r_har.RData")
q()
source('~/Box Sync/19Fall/har/rcode/main.R')
View(cv_max)
source('~/Box Sync/19Fall/har/rcode/main.R')
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/r_har.RData")
View(reject_cmax)
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/r_har.RData")
View(power_pp)
View(power_cmax)
View(power_pp)
power_pp[21]
power_pp[11]
?if
q
xxx <- for(i in 1:10){x[1]=i}
x < rep(0,10)
x <- rep(0,10)
xxx <- for(i in 1:10){x[1]=i}
xxx
?save
source('~/Box Sync/19Fall/har/rcode/main.R')
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/h0.RData")
View(power_pp)
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/r_har_h1.RData")
View(power_cmax)
View(power_pp)
View(power_pp)
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/h0.RData")
View(reject_pp)
View(power_pp)
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/h1.RData")
View(power_pp)
power_pp[21]
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/h0.RData")
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/h0.RData")
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/test.RData")
View(`F`)
View(cv_max)
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/test.RData")
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/h10.RData")
View(power_cmax)
source('~/Box Sync/19Fall/har/rcode/main.R')
source('~/Box Sync/19Fall/har/rcode/main.R')
X
X[3:5]%*%beta0
X[3:5]
X%*%beta0
X[3:5]%*%beta0
(X[3:5])%*%beta0
(X[3:5,])%*%beta0
(X[3:5,])*beta0
X[3:5] %*% beta0
X[3:5]
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/h_estimate.RData")
q()
install.packages('optim_nm')
install.packages('optim_nm')
?optim_nm
?optimize
?optimize
source('~/Box Sync/19Fall/har/rcode/main.R')
source('~/Box Sync/19Fall/har/rcode/main.R')
q()
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
setTxtProgressBar(pb, v)
setTxtProgressBar(pb, 3)
setTxtProgressBar(pb, 8)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
X
R
c(x,y) <- c(2,1)
x <- matrix(3,ncol=10,nrow=3)
stopCluster(cl)
x <- matrix(3,ncol=10,nrow=3)
x
y <- matrix(4,ncol=2,nrow=3)
c(x,y)
matrix(c(x,y),ncol=12,nrow=3)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
stopCluster(cl)
X
sp.x <-1
sp.x
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
stopCluster(cl)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
stopCluster(cl)
stopCluster(cl)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
Data
Data[,2]
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
x <- 1:10
seq_along(x)
x <- rnorm(10)
seq_along(x)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
parallel::stopCluster(cl)
source('~/Box Sync/19Fall/har/rcode/test.R')
out
out[8]
out[[8]]
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
q()
View(power_cmax)
q()
View(power_cmax)
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/Bonf_test.RData")
View(power)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
rho.andrews93
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
load("~/Box Sync/19Fall/har/rcode/test.RData")
View(power)
load("~/Box Sync/19Fall/har/rcode/test.RData")
View(power)
load("/Users/chenzhang/Box Sync/19Fall/har/rcode/test.RData")
View(power)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
grid <- c(seq(0,0.9,0.05),0.93,0.95,0.97,0.99,1)
id <- sum(rho_ls>rho.andrews93)
id <- sum(r_ls>rho.andrews93)
id <- sum(0.9>rho.andrews93)
id
h <- T*(1-grid[id])
h
matrix(0,nrow = length(Time),ncol = Nsim)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
View(power)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
View(power)
View(reject)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
View(power)
T*(1-0.9)
T*(1-0.5)
T*(1-0.3)
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
stopCluster(cl)
stopCluster(cl)
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
View(rho.sim)
rho.grid
View(Y)
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
apply(Y[(Tsim-T):(Tsim-1),]*Y[(Tsim-T+1):Tsim,],2,sum)/apply(Y[(Tsim-T):(Tsim-1),]*Y[(Tsim-T):(Tsim-1),],2,sum)
x <- apply(Y[(Tsim-T):(Tsim-1),]*Y[(Tsim-T+1):Tsim,],2,sum)/apply(Y[(Tsim-T):(Tsim-1),]*Y[(Tsim-T):(Tsim-1),],2,sum)
x
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
x <- apply(Y[(Tsim-T):(Tsim-1),]*Y[(Tsim-T+1):Tsim,],2,sum)/apply(Y[(Tsim-T):(Tsim-1),]*Y[(Tsim-T):(Tsim-1),],2,sum)
x
rho_q
View(Y)
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_tmp*Y[1:(Tsim-1)]
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
?apply
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/test.R')
source('~/Box Sync/19Fall/har/rcode/test.R')
source('~/Box Sync/19Fall/har/rcode/test.R')
View(X)
source('~/Box Sync/19Fall/har/rcode/test.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/test.R')
rho_q
eye(5)
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
I <- diag(T)
I
P
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_q
source('~/Box Sync/19Fall/har/rcode/ar.rho_quantile.R')
rho_tmp*Y[1:(Tsim-1),]
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
matrix(1,nrow=T-1,ncol=T-1)
eye
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
et <- Data[2:T,3]
et_1 <- Data[1:T-1,3]
idm <- diag(T-1)
P <- matrix(1,nrow=T-1,ncol=T-1)
r_ls <- t(et_1)%*%(idm-P)%*%et/(t(et_1)%*%(idm-P)%*%et_1)
r_ls
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
Data[,i]
sim.Y <- Data[,i]
sim.X <- Data[,i+I]
et <- sim.Y[2:T]-sim.X[2:T]*beta0
et_1 <- sim.Y[1:T-1]-sim.X[1:T-1]*beta0
idm <- diag(T-1)
P <- matrix(1,nrow=T-1,ncol=T-1)
r_ls <- t(et_1)%*%(idm-P)%*%et/(t(et_1)%*%(idm-P)%*%et_1)
r_ls
grid <- c(seq(0,0.9,0.05),0.93,0.95,0.97,0.99,1)
id <- sum(r_ls>rho.andrews93)
r_ls>rho.andrews93
rho.andrews93
r_ls>matrix(rho.andrews93)
3>c(1,2)
3> matrix(c(1,2,4))
View(r_ls)
r_ls > rho.andrews93
r_ls > c(3,5,1)
typeof(r_ls)
dim(r_ls)
1 > rho.andrews93
typeof(1)
dim(1)
typeof(as.numeric(r_ls))
c(r_ls)>rho.andrews93
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
sim.Y <- Data[,i]
sim.X <- Data[,i+I]
et <- sim.Y[2:T]-sim.X[2:T]*beta0
et_1 <- sim.Y[1:T-1]-sim.X[1:T-1]*beta0
idm <- diag(T-1)
P <- matrix(1,nrow=T-1,ncol=T-1)
r_ls <- t(et_1)%*%(idm-P)%*%et/(t(et_1)%*%(idm-P)%*%et_1)
grid <- c(seq(0,0.9,0.05),0.93,0.95,0.97,0.99,1)
id <- sum(c(r_ls)>rho.andrews93)
h <- T*(1-grid[id])  #ar.rho_max(rho_ls,alpha-delta,T,Nsim))
grid[id]
length(grid)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
View(power)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
View(power)
debugSource('~/Box Sync/19Fall/har/rcode/funize_main.R')
debugSource('~/Box Sync/19Fall/har/rcode/funize_main.R')
power[,n_b] <- apply(reject,1,mean)
sim.Y <- Data[,i]
sim.X <- Data[,i+I]
et <- sim.Y[2:T]-sim.X[2:T]*beta0
et_1 <- sim.Y[1:T-1]-sim.X[1:T-1]*beta0
idm <- diag(T-1)
P <- matrix(1,nrow=T-1,ncol=T-1)
r_ls <- t(et_1)%*%(idm-P)%*%et/(t(et_1)%*%(idm-P)%*%et_1)
?solve
?inverse
solve(diag(3))
solve(diag(3)*0.5)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
sim.Y <- Data[,i]
sim.X <- Data[,i+I]
et <- sim.Y[2:T] #-sim.X[2:T]*beta0
et_1 <- sim.Y[1:T-1] #-sim.X[1:T-1]*beta0
idm <- diag(T-1)
X2 <- matrix(c(rep(1,T-1),sim.X[2:T]),nrow=T-1)
P <- X2%*%solve(t(X2)%*%X2)%*%t(X2)
r_ls <- t(et_1)%*%(idm-P)%*%et/(t(et_1)%*%(idm-P)%*%et_1)
grid <- c(seq(0,0.9,0.05),0.93,0.95,0.97,0.99,0.995,1)
id <- sum(c(r_ls)>rho.andrews93)
h <- T*(1-grid[id])  #ar.rho_max(rho_ls,alpha-delta,T,Nsim))
cv_max <- optimize(cmax.fun,interval=c(delta_low,alpha),h=h,alpha=alpha,K=K,T=T,Nsim=Nsim)[[2]]
vhat <- sim.X*(sim.Y-sim.X*beta0)
F <- (sum(vhat))^2*K*(sum((t(phi)%*%vhat)^2))^-1
reject_cmax <- F>cv_max
cv_pp <- critical.value(alpha, ar.order.max, bandwidth, ker, R, sim.X, N0, N1, N2, Mp, M1,
M2, Eicker = FALSE,opt.method.1 = "Nelder-Mead",opt.method.2 = "Nelder-Mead",
control.1 = list("reltol" = N1^(-.5), "maxit" = dim(sim.X)[1]*20),
control.2 = list("reltol" = N2^(-.5), "maxit" = dim(sim.X)[1]*30),
cores = 1, margin = rep(1, length = ar.order.max))[[8]]
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
View(reject)
View(power)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
View(power)
power[21]
power[,21]
sim.Y <- Data[,i]
sim.Y <- Data[,3]
sim.X <- Data[,3+I]
et <- sim.Y[2:T] -sim.X[2:T]*beta0
et_1 <- sim.Y[1:T-1] -sim.X[1:T-1]*beta0
idm <- diag(T-1)
#X2 <- matrix(c(rep(1,T-1),sim.X[2:T]),nrow=T-1)
#P <- X2%*%solve(t(X2)%*%X2)%*%t(X2)
r_ls <- t(et_1)%*%et/(t(et_1)%*%et_1)
grid <- c(seq(0,0.9,0.05),0.93,0.95,0.97,0.99,0.995,1)
id <- sum(c(r_ls)>rho.andrews93)
h <- T*(1-grid[id])  #ar.rho_max(rho_ls,alpha-delta,T,Nsim))
load("~/Box Sync/19Fall/har/rcode/test.RData")
View(power)
load("~/Box Sync/19Fall/har/rcode/Bonf_test.RData")
View(power)
q()
load("~/Box Sync/19Fall/har/rcode/Bonf_test.RData")
View(power)
load("~/Box Sync/19Fall/har/rcode/Bonf_test.RData")
View(power)
source('~/Box Sync/19Fall/har/rcode/funize_main.R')
stopCluster(cl)
load("~/Box Sync/19Fall/har/rcode/Bonf_test.RData")
View(power)
q90
q()
